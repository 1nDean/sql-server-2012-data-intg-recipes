CREATE FUNCTION dbo.fn_PatternProfile
(
@STRING VARCHAR(4000)
,@NUMERICPATTERN CHAR(1)
,@TEXTPATTERN CHAR(1)
)
RETURNS VARCHAR(4000)
AS
BEGIN
DECLARE @STRINGPOS INT= 1;
DECLARE @TESTCHAR CHAR(1)= '';
DECLARE @PATTERNCHAR CHAR(1)= '';
DECLARE @PATTERNOUT VARCHAR(4000)= '';
WHILE @STRINGPOS <= LEN(@STRING)
BEGIN
SET @TESTCHAR = SUBSTRING(@STRING,@STRINGPOS,1)


IF @TESTCHAR
IN('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W',
'X','Y','Z')
SET @PATTERNCHAR = @TEXTPATTERN
ELSE IF UPPER(@TESTCHAR) IN('1','2','3','4','5','6','7','8','9')
SET @PATTERNCHAR = @NUMERICPATTERN
ELSE SET @PATTERNCHAR = @TESTCHAR
SET @PATTERNOUT = @PATTERNOUT + @PATTERNCHAR
SET @STRINGPOS = @STRINGPOS + 1
END;
RETURN(@PATTERNOUT)
END;